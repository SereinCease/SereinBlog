---
0title: OS第二章进程与线程
date: 2024-03-28 11:11:29
tags: 操作系统
categories:
cover:
description:
---

# 2.1进程与线程

## 1.进程

![](https://cdn.jsdelivr.net/gh/SereinCease/images/blog/2024-03-28/20240328110941-f1ff10.png)

## 2.进程状态与转换

![](https://cdn.jsdelivr.net/gh/SereinCease/images/blog/2024-03-28/20240328110920-c2e37c.png)

## 3.进程控制

使用原语（关中断和开中断）

### （1）进程的创建

**创建进程时的操作**：申请空白PCB；分配资源；初始化PCB；将PCB插入就绪队列

**引起进程创建的事件**：用户登录，作业调度，系统提供服务，用户程序的应用请求

### （2）进程的终止

**终止进程时的操作**：从PCB集合中找到终止进程的PCB；如果进程正在运行，剥夺它的CPU，将CPU分配给其他进程；终止它所有的子进程；将该进程拥有的资源归还给父进程或操作系统；删除PCB

**引起进程终止的事件**：正常结束；异常结束（存储区越界，保护错，非法指令，特权指令错，运行超时，算数运算错，I/O故障）；外界干预

### （3）进程的阻塞和唤醒

阻塞进程时的操作：

引起进程阻塞的事件：等待系统分配某种资源，等待相互合作的进程完成工作

唤醒进程时的操作

引起进程唤醒的事件：等待的事情发生             *                                                                                                                                 

# 3.同步与互斥

1.注意：临界区是访问临界资源的那段代码，进入区和退出区是负责实现互斥的那段代码

2.四个原则：空闲让进，忙则等待，有限等待，让权等待

![]()

![]()

![]()

![]()

![]()

![]()





- 文件的基本概念
  - FCB文件控制块
  - 索引节点（FCB的改进）：文件名和文件描述信息分离，大大提升检索速度
    - 磁盘索引节点（外存）
    - 内存索引节点（内存）
      - 需要增加一些信息：文件是否被修改
- 文件的操作
  - ​      \#操作系统向上提供方便易用的服务    
    - create，delete，open，close，read，write系统调用
- [[文件的逻辑结构]]--文件内部如何被组织起来
  - 数据项是文件系统中最基本的数据单位，记录是一组相关数据项的集合
  - 有结构文件（记录式文件）：数据库文件，每条记录有一个数据项可作为关键字
    - 顺序文件（默认物理上顺序存储的顺序文件）
      - 可变长记录：无法随机存取
      - 定长记录：可以随机存取
        - 串结构（记录顺序与关键字无关，通常用记录存入的时间排序）：无法快速查找关键字
        - 顺序结构（记录顺序与关键字有关）：可以快速查找
      - 缺点：增加/删除一个记录比较困难
    - 索引文件：建立索引表（定长记录的顺序文件）加快检索速度，一个记录对应一张索引表
      - 主要用于对信息处理及时性较高的场合
      - 可以用不同的数据项建立多个索引表
    - 索引顺序文件：一组记录对应一个索引表
      - 多级索引顺序文件：建立多级索引表
    - 直接文件或散列文件
  - 无结构文件（流式文件）：二进制或文本文件
- [[目录]]结构--文件之间如何被组织起来
  - 单级目录结构
    - 实现了按名存取，查找速度慢，文件不允许重名，不利于文件共享
  - 两级目录结构
    - 分为主文件目录和用户文件目录
    - 解决了文件重名问题，可以实现目录的访问限制，灵活性差，用户不能对文件分类
  - 多级目录结构/树形目录结构
    - 使用路径名标识文件
    - 绝对路径：从根目录出发
    - 相对路径：从当前目录出发
    - 可以方便的对文件进行分类，但是不利于文件的共享
  - 无环图目录结构（有向无环图）
    - 可以用不同的文件名指向同一个文件
    - 为共享的文件设置一个共享计数器，当删除文件时，如果共享计数器不为0，就只删除用户的FCB，同时把共享计数器的值减一，只有当共享计数器的值为0时，才删除节点
    - 当一个用户修改共享文件时，所有用户都可以看到文件的变化
- [[文件的物理结构]]--文件应如何存放在外存中->类比内存中分成一个一个页面
  - 连续分配：每个文件在磁盘上占有一组连续的块
    - 物理块号=逻辑块号+起始块号
    - 支持顺序访问和随机访问，顺序读/写时速度最快
    - 不方便文件拓展，存储空间利用率低，会存在难以利用的磁盘碎片，可使用紧凑技术解决
  - 链接分配
    - 隐式链接
      - 只支持顺序访问，不支持随机访问
      - 外存利用率高，方便文件拓展，不会有碎片问题，查找效率低
    - 显式链接
      - 一个磁盘仅设置一张FAT（文件分配表），开机时将FAT读内存，并常驻内存
      - 逻辑块号转换成物理块号不需要读内存
      - 支持随机访问，也支持随机访问，方便文件拓展，不会产生外部碎片。地址转换不需要访问磁盘
  - 索引分配
- 存储空间的管理--os如何管理外存中的空闲块
- os提供的其他文件管理功能
  - 文件共享
  - 文件保护
